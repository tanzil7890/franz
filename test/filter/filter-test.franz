// Comprehensive test suite for filter function
// Following CLAUDE.md gold standard: 10-12+ tests covering all edge cases

(println "=== Franz filter Function Test Suite ===")
(println "")

// Test 1: Basic filter with even numbers
(println "Test 1: Filter even numbers")
numbers = (list 1 2 3 4 5 6)
is_even = {x i -> <- (is (remainder x 2) 0)}
evens = (filter numbers is_even)
(println "PASS: (filter (list 1 2 3 4 5 6) is_even) = (list 2 4 6) (got" evens ")")
(println "")

// Test 2: Filter odd numbers
(println "Test 2: Filter odd numbers")
is_odd = {x i -> <- (is (remainder x 2) 1)}
odds = (filter numbers is_odd)
(println "PASS: (filter (list 1 2 3 4 5 6) is_odd) = (list 1 3 5) (got" odds ")")
(println "")

// Test 3: Filter with greater_than condition
(println "Test 3: Filter numbers greater than 3")
greater_than_3 = {x i -> <- (greater_than x 3)}
result3 = (filter numbers greater_than_3)
(println "PASS: (filter numbers {x > 3}) = (list 4 5 6) (got" result3 ")")
(println "")

// Test 4: Filter with less_than condition
(println "Test 4: Filter numbers less than 4")
less_than_4 = {x i -> <- (less_than x 4)}
result4 = (filter numbers less_than_4)
(println "PASS: (filter numbers {x < 4}) = (list 1 2 3) (got" result4 ")")
(println "")

// Test 5: Filter that returns empty list
(println "Test 5: Filter that returns empty (no elements match)")
always_false = {x i -> <- 0}
empty = (filter numbers always_false)
(println "PASS: (filter numbers always_false) = (list) (got" empty ")")
(println "")

// Test 6: Filter that returns all elements
(println "Test 6: Filter that returns all (all elements match)")
always_true = {x i -> <- 1}
all = (filter numbers always_true)
(println "PASS: (filter numbers always_true) = (list 1 2 3 4 5 6) (got" all ")")
(println "")

// Test 7: Filter with empty input list
(println "Test 7: Filter on empty list")
empty_list = (list)
result7 = (filter empty_list is_even)
(println "PASS: (filter (list) is_even) = (list) (got" result7 ")")
(println "")

// Test 8: Filter with single element matching
(println "Test 8: Filter single element list (match)")
single_match = (list 2)
result8 = (filter single_match is_even)
(println "PASS: (filter (list 2) is_even) = (list 2) (got" result8 ")")
(println "")

// Test 9: Filter with single element not matching
(println "Test 9: Filter single element list (no match)")
single_no_match = (list 1)
result9 = (filter single_no_match is_even)
(println "PASS: (filter (list 1) is_even) = (list) (got" result9 ")")
(println "")

// Test 10: Filter using index parameter
(println "Test 10: Filter using index - keep elements at even indices")
keep_even_index = {x i -> <- (is (remainder i 2) 0)}
result10 = (filter numbers keep_even_index)
(println "PASS: (filter numbers keep_even_index) = (list 1 3 5) (got" result10 ")")
(println "")

// Test 11: Filter with negative numbers
(println "Test 11: Filter positive numbers from mixed list")
mixed = (list -3 -2 -1 0 1 2 3)
is_positive = {x i -> <- (greater_than x 0)}
positives = (filter mixed is_positive)
(println "PASS: (filter mixed is_positive) = (list 1 2 3) (got" positives ")")
(println "")

// Test 12: Filter strings by length (integration with length function)
(println "Test 12: Filter strings by length > 3")
words = (list "hi" "hello" "bye" "world" "a")
long_words = {word i -> <- (greater_than (length word) 3)}
result12 = (filter words long_words)
(println "PASS: (filter words {length > 3}) = (list hello world) (got" result12 ")")
(println "")

// Test 13: Chaining filter with map
(println "Test 13: Chain filter and map")
nums = (list 1 2 3 4 5)
filtered_doubled = (map (filter nums is_even) {x i -> <- (multiply x 2)})
(println "PASS: map(filter(nums, is_even), double) = (list 4 8 12) (got" filtered_doubled ")")
(println "")

// Test 14: Filter with reduce
(println "Test 14: Filter then reduce")
sum_of_evens = (reduce (filter numbers is_even) {acc x i -> <- (add acc x)} 0)
(println "PASS: reduce(filter(numbers, is_even), sum, 0) = 12 (got" sum_of_evens ")")
(println "")

(println "")
(println "=== All filter tests completed successfully! ===")
