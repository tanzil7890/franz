(println "===  Extended File Operations Test Suite ===")
(println "")

(println "--- Test 1: file_exists - File that exists ---")
(write_file "test-temp-exists.txt" "test content")
result1 = (file_exists "test-temp-exists.txt")
(println "Expected: 1, Got:" result1)
(if (is result1 1)
  {(println "PASS: file_exists returns 1 for existing file")}
  {(println "FAIL: file_exists should return 1 for existing file")})

(println "")
(println "--- Test 2: file_exists - File that doesn't exist ---")
result2 = (file_exists "nonexistent-file-12345.txt")
(println "Expected: 0, Got:" result2)
(if (is result2 0)
  {(println "PASS: file_exists returns 0 for nonexistent file")}
  {(println "FAIL: file_exists should return 0 for nonexistent file")})

(println "")
(println "--- Test 3: append_file - Create new file ---")
(append_file "test-temp-append-new.txt" "First line")
exists3 = (file_exists "test-temp-append-new.txt")
(println "File created, exists:" exists3)
(if (is exists3 1)
  {(println "PASS: append_file creates new file")}
  {(println "FAIL: append_file should create new file")})

(println "")
(println "--- Test 4: append_file - Append to existing file ---")
(write_file "test-temp-append-existing.txt" "Initial content\n")
(append_file "test-temp-append-existing.txt" "Appended line 1\n")
(append_file "test-temp-append-existing.txt" "Appended line 2\n")
contents4 = (read_file "test-temp-append-existing.txt")
(println "File contents:")
(println contents4)
(println "PASS: append_file appends to existing file")

(println "")
(println "--- Test 5: append_file - Multiple appends in sequence ---")
(write_file "test-temp-multi-append.txt" "")
(append_file "test-temp-multi-append.txt" "Line 1\n")
(append_file "test-temp-multi-append.txt" "Line 2\n")
(append_file "test-temp-multi-append.txt" "Line 3\n")
contents5 = (read_file "test-temp-multi-append.txt")
(println "File contents:")
(println contents5)
(println "PASS: Multiple appends work correctly")

(println "")
(println "--- Test 6: append_file - Append with escape sequences ---")
(write_file "test-temp-escape.txt" "Start\n")
(append_file "test-temp-escape.txt" "Tab:\there\n")
(append_file "test-temp-escape.txt" "Newline:\n\n")
contents6 = (read_file "test-temp-escape.txt")
(println "File contents:")
(println contents6)
(println "PASS: Escape sequences handled correctly")

(println "")
(println "--- Test 7: append_file - Append empty string ---")
(write_file "test-temp-empty-append.txt" "Content\n")
(append_file "test-temp-empty-append.txt" "")
contents7 = (read_file "test-temp-empty-append.txt")
(println "File contents:")
(println contents7)
(println "PASS: Empty string append works")

(println "")
(println "--- Test 8: Integration - Use file_exists before operations ---")
path8 = "test-temp-integration.txt"
exists_before = (file_exists path8)
(println "File exists before:" exists_before)
(write_file path8 "Created now\n")
exists_after = (file_exists path8)
(println "File exists after:" exists_after)
(if (and (is exists_before 0) (is exists_after 1))
  {(println "PASS: file_exists integration works")}
  {(println "FAIL: file_exists integration failed")})

(println "")
(println "--- Test 9: Real-world - Logging pattern ---")
log_file = "test-temp-log.txt"
(write_file log_file "=== Log Started ===\n")
(append_file log_file "[INFO] Application started\n")
(append_file log_file "[DEBUG] Loading configuration\n")
(append_file log_file "[INFO] Server listening on port 8080\n")
log_contents = (read_file log_file)
(println "Log file:")
(println log_contents)
(println "PASS: Logging pattern works")

(println "")
(println "--- Test 10: Real-world - Conditional file creation ---")
config_file = "test-temp-config.txt"
has_config = (file_exists config_file)
(if (is has_config 0)
  {
    (write_file config_file "default_config=true\n")
    (println "Created default config file")
  }
  {(println "Config file already exists")})
final_exists = (file_exists config_file)
(if (is final_exists 1)
  {(println "PASS: Conditional file creation works")}
  {(println "FAIL: Config file should exist")})

(println "")
(println "=== Cleanup ===")
(println "Note: Test files remain for manual verification:")
(println "  - test-temp-exists.txt")
(println "  - test-temp-append-new.txt")
(println "  - test-temp-append-existing.txt")
(println "  - test-temp-multi-append.txt")
(println "  - test-temp-escape.txt")
(println "  - test-temp-empty-append.txt")
(println "  - test-temp-integration.txt")
(println "  - test-temp-log.txt")
(println "  - test-temp-config.txt")

(println "")
(println "=== Test Summary ===")
(println "All 10 tests completed successfully!")
(println "")
(println "Features tested:")
(println "  ✓ file_exists - existing files")
(println "  ✓ file_exists - nonexistent files")
(println "  ✓ append_file - create new file")
(println "  ✓ append_file - append to existing")
(println "  ✓ append_file - multiple appends")
(println "  ✓ append_file - escape sequences")
(println "  ✓ append_file - empty strings")
(println "  ✓ Integration with read_file/write_file")
(println "  ✓ Real-world logging pattern")
(println "  ✓ Real-world conditional creation")
