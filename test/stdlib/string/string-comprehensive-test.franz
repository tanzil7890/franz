// Franz Standard Library - String Module
// Comprehensive Test Suite for All 10 Functions

(use "stdlib/string.franz" {
  (println "==================================================")
  (println "Franz String Module - Comprehensive Test Suite")
  (println "Testing all 10 string functions")
  (println "==================================================")
  (println "")

  test_count = 0
  pass_count = 0

  // ========================================================================
  // 1. uppercase() Tests
  // ========================================================================

  (println "1. uppercase() - 3 tests")

  test_count = (add test_count 1)
  (if (is (uppercase "hello") "HELLO\n") {
    pass_count = (add pass_count 1)
    (println "  ✓ Test 1.1: uppercase basic")
  } {
    (println "  ✗ Test 1.1: FAILED")
  })

  test_count = (add test_count 1)
  (if (is (uppercase "Hello World") "HELLO WORLD\n") {
    pass_count = (add pass_count 1)
    (println "  ✓ Test 1.2: uppercase mixed case")
  } {
    (println "  ✗ Test 1.2: FAILED")
  })

  test_count = (add test_count 1)
  (if (is (uppercase "abc123") "ABC123\n") {
    pass_count = (add pass_count 1)
    (println "  ✓ Test 1.3: uppercase with numbers")
  } {
    (println "  ✗ Test 1.3: FAILED")
  })

  // ========================================================================
  // 2. lowercase() Tests
  // ========================================================================

  (println "")
  (println "2. lowercase() - 3 tests")

  test_count = (add test_count 1)
  (if (is (lowercase "HELLO") "hello\n") {
    pass_count = (add pass_count 1)
    (println "  ✓ Test 2.1: lowercase basic")
  } {
    (println "  ✗ Test 2.1: FAILED")
  })

  test_count = (add test_count 1)
  (if (is (lowercase "Hello World") "hello world\n") {
    pass_count = (add pass_count 1)
    (println "  ✓ Test 2.2: lowercase mixed case")
  } {
    (println "  ✗ Test 2.2: FAILED")
  })

  test_count = (add test_count 1)
  (if (is (lowercase "ABC123") "abc123\n") {
    pass_count = (add pass_count 1)
    (println "  ✓ Test 2.3: lowercase with numbers")
  } {
    (println "  ✗ Test 2.3: FAILED")
  })

  // ========================================================================
  // 3. trim() Tests
  // ========================================================================

  (println "")
  (println "3. trim() - 4 tests")

  test_count = (add test_count 1)
  (if (is (trim "  hello  ") "hello\n") {
    pass_count = (add pass_count 1)
    (println "  ✓ Test 3.1: trim both sides")
  } {
    (println "  ✗ Test 3.1: FAILED")
  })

  test_count = (add test_count 1)
  (if (is (trim "hello") "hello\n") {
    pass_count = (add pass_count 1)
    (println "  ✓ Test 3.2: trim no spaces")
  } {
    (println "  ✗ Test 3.2: FAILED")
  })

  test_count = (add test_count 1)
  (if (is (trim "  hello world  ") "hello world\n") {
    pass_count = (add pass_count 1)
    (println "  ✓ Test 3.3: trim preserves internal spaces")
  } {
    (println "  ✗ Test 3.3: FAILED")
  })

  test_count = (add test_count 1)
  (if (is (trim "  ") "\n") {
    pass_count = (add pass_count 1)
    (println "  ✓ Test 3.4: trim only spaces")
  } {
    (println "  ✗ Test 3.4: FAILED")
  })

  // ========================================================================
  // 4. replace() Tests
  // ========================================================================

  (println "")
  (println "4. replace() - 3 tests")

  test_count = (add test_count 1)
  (if (is (replace "hello world" "world" "Franz") "hello Franz\n") {
    pass_count = (add pass_count 1)
    (println "  ✓ Test 4.1: replace basic")
  } {
    (println "  ✗ Test 4.1: FAILED")
  })

  test_count = (add test_count 1)
  (if (is (replace "aaa" "a" "b") "bbb\n") {
    pass_count = (add pass_count 1)
    (println "  ✓ Test 4.2: replace all occurrences")
  } {
    (println "  ✗ Test 4.2: FAILED")
  })

  test_count = (add test_count 1)
  (if (is (replace "hello" "xyz" "abc") "hello\n") {
    pass_count = (add pass_count 1)
    (println "  ✓ Test 4.3: replace no match")
  } {
    (println "  ✗ Test 4.3: FAILED")
  })

  // ========================================================================
  // 5. repeat() Tests
  // ========================================================================

  (println "")
  (println "5. repeat() - 4 tests")

  test_count = (add test_count 1)
  (if (is (repeat "ab" 3) "ababab") {
    pass_count = (add pass_count 1)
    (println "  ✓ Test 5.1: repeat basic")
  } {
    (println "  ✗ Test 5.1: FAILED")
  })

  test_count = (add test_count 1)
  (if (is (repeat "x" 5) "xxxxx") {
    pass_count = (add pass_count 1)
    (println "  ✓ Test 5.2: repeat single char")
  } {
    (println "  ✗ Test 5.2: FAILED")
  })

  test_count = (add test_count 1)
  (if (is (repeat "test" 0) "") {
    pass_count = (add pass_count 1)
    (println "  ✓ Test 5.3: repeat zero times")
  } {
    (println "  ✗ Test 5.3: FAILED")
  })

  test_count = (add test_count 1)
  (if (is (repeat "hi" 1) "hi") {
    pass_count = (add pass_count 1)
    (println "  ✓ Test 5.4: repeat once")
  } {
    (println "  ✗ Test 5.4: FAILED")
  })

  // ========================================================================
  // 6. starts_with() Tests
  // ========================================================================

  (println "")
  (println "6. starts_with() - 3 tests")

  test_count = (add test_count 1)
  (if (is (starts_with "hello world" "hello") 1) {
    pass_count = (add pass_count 1)
    (println "  ✓ Test 6.1: starts_with match")
  } {
    (println "  ✗ Test 6.1: FAILED")
  })

  test_count = (add test_count 1)
  (if (is (starts_with "hello world" "world") 0) {
    pass_count = (add pass_count 1)
    (println "  ✓ Test 6.2: starts_with no match")
  } {
    (println "  ✗ Test 6.2: FAILED")
  })

  test_count = (add test_count 1)
  (if (is (starts_with "test" "test") 1) {
    pass_count = (add pass_count 1)
    (println "  ✓ Test 6.3: starts_with exact match")
  } {
    (println "  ✗ Test 6.3: FAILED")
  })

  // ========================================================================
  // 7. ends_with() Tests
  // ========================================================================

  (println "")
  (println "7. ends_with() - 3 tests")

  test_count = (add test_count 1)
  (if (is (ends_with "hello world" "world") 1) {
    pass_count = (add pass_count 1)
    (println "  ✓ Test 7.1: ends_with match")
  } {
    (println "  ✗ Test 7.1: FAILED")
  })

  test_count = (add test_count 1)
  (if (is (ends_with "hello world" "hello") 0) {
    pass_count = (add pass_count 1)
    (println "  ✓ Test 7.2: ends_with no match")
  } {
    (println "  ✗ Test 7.2: FAILED")
  })

  test_count = (add test_count 1)
  (if (is (ends_with "test" "test") 1) {
    pass_count = (add pass_count 1)
    (println "  ✓ Test 7.3: ends_with exact match")
  } {
    (println "  ✗ Test 7.3: FAILED")
  })

  // ========================================================================
  // 8. contains() Tests
  // ========================================================================

  (println "")
  (println "8. contains() - 3 tests")

  test_count = (add test_count 1)
  (if (is (contains "hello world" "wor") 1) {
    pass_count = (add pass_count 1)
    (println "  ✓ Test 8.1: contains match")
  } {
    (println "  ✗ Test 8.1: FAILED")
  })

  test_count = (add test_count 1)
  (if (is (contains "hello world" "xyz") 0) {
    pass_count = (add pass_count 1)
    (println "  ✓ Test 8.2: contains no match")
  } {
    (println "  ✗ Test 8.2: FAILED")
  })

  test_count = (add test_count 1)
  (if (is (contains "test" "test") 1) {
    pass_count = (add pass_count 1)
    (println "  ✓ Test 8.3: contains exact match")
  } {
    (println "  ✗ Test 8.3: FAILED")
  })

  // ========================================================================
  // 9. char_at() Tests
  // ========================================================================

  (println "")
  (println "9. char_at() - 4 tests")

  test_count = (add test_count 1)
  (if (is (char_at "hello" 0) "h\n") {
    pass_count = (add pass_count 1)
    (println "  ✓ Test 9.1: char_at index 0")
  } {
    (println "  ✗ Test 9.1: FAILED")
  })

  test_count = (add test_count 1)
  (if (is (char_at "hello" 4) "o\n") {
    pass_count = (add pass_count 1)
    (println "  ✓ Test 9.2: char_at last index")
  } {
    (println "  ✗ Test 9.2: FAILED")
  })

  test_count = (add test_count 1)
  (if (is (char_at "hello" 2) "l\n") {
    pass_count = (add pass_count 1)
    (println "  ✓ Test 9.3: char_at middle index")
  } {
    (println "  ✗ Test 9.3: FAILED")
  })

  test_count = (add test_count 1)
  (if (is (char_at "a" 0) "a\n") {
    pass_count = (add pass_count 1)
    (println "  ✓ Test 9.4: char_at single char")
  } {
    (println "  ✗ Test 9.4: FAILED")
  })

  // ========================================================================
  // 10. split() Tests (Note: Returns multi-line string, not list yet)
  // ========================================================================

  (println "")
  (println "10. split() - 2 tests")

  test_count = (add test_count 1)
  split_result = (split "a,b,c" ",")
  (if (contains split_result "a") {
    pass_count = (add pass_count 1)
    (println "  ✓ Test 10.1: split basic (contains 'a')")
  } {
    (println "  ✗ Test 10.1: FAILED")
  })

  test_count = (add test_count 1)
  split_result2 = (split "hello world" " ")
  (if (contains split_result2 "hello") {
    pass_count = (add pass_count 1)
    (println "  ✓ Test 10.2: split by space (contains 'hello')")
  } {
    (println "  ✗ Test 10.2: FAILED")
  })

  // ========================================================================
  // Summary
  // ========================================================================

  (println "")
  (println "==================================================")
  (println (join "Total Tests: " (string test_count)))
  (println (join "Passed: " (string pass_count)))
  failed_count = (subtract test_count pass_count)
  (println (join "Failed: " (string failed_count)))
  pass_rate = (multiply (divide pass_count test_count) 100)
  (println (join "Pass Rate: " (string pass_rate) "%"))
  (println "==================================================")

  (if (is pass_count test_count) {
    (println "✓ ALL TESTS PASSED!")
  } {
    (println "✗ Some tests failed - review above")
  })
})
